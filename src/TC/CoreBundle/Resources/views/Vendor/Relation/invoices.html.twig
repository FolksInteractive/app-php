{% extends 'TCCoreBundle:Vendor:skeleton.html.twig' %}

{% use "TCCoreBundle:Relation:invoices.html.twig" with body_class as base_body_class %}

{% use "TCCoreBundle:Vendor:Relation/menu.html.twig" %}

{% block body_class %} {{parent()}} {{ block('base_body_class') }}  {% endblock %}

{# block main_before %} 
{% set attr = {'name':form.vars.name} %}
{% set attr = attr|merge({'ng-app':''}) %}
{% set attr = attr|merge({'novalidate':""}) %}   
{{form_start(form, {'attr':attr})}}
{% endblock #}

{# block main_after %}
{{form_widget(form._token)}}
{{form_end(form, {"render_rest":false})}}
{% endblock #}

{% block toolbar %}
<div class="tc-breadcrumb pull-left">
        {% set menu = knp_menu_get('TCCoreBundle:VendorMenuBuilder:invoicesMenu',[],{"relation": relation}) %}

        {{ knp_menu_render(menu, {'template': 'TCCoreBundle::breadcrumbs.html.twig'}) }}
    </div>

    <div class="tc-controls pull-right">
    {#
        {% set attr = {'class':''} %}
        {% set attr = attr|merge({'ng-disabled':"!"~ form.vars.name ~ ".$dirty"}) %}   
        {% set attr = attr|merge({'disabled':""}) %}   
        {% set attr = attr|merge({'ng-class': form.vars.name ~ ".$dirty && 'btn-primary'"}) %}   
        {{form_widget(form.submit, {'attr':attr})}}
    #}
        </div>
{% endblock %}

{% block sheet %}
        <div class="tc-invoices-section">  

            <table  class="tc-table tc-invoices table">
                <thead>
                    <tr>
                        <th class="number">Invoice</th>
                        <th class="description">Description</th>
                        <th class="status">Status</th>
                        <th class="subtotal">Total</th>
                    </tr>
                </thead>
                <tbody>
        {# for bill in relation.getClosedBills() %}
            <tr class="invoice">
                <td class="description">
                    <a href="{{path('vendor_invoice_show',{'idBill':bill.id,'idRelation': relation.id})}}">
                        {{'Invoice #'~bill.id}}
                    </a>
                </td>
                <td class="closed-at">
                    {{ bill.getClosedAt()|date('d M ') }}
                </td>
                <td class="total">
                    $ {{bill.total|number_format(2, '.', ',')}}
                </td>
            </tr>     
        {% endfor #}

                        <tr>
                            <td class="number">00001</td>
                            <td class="description">
                                <div class="title"><a href="#">Courses Upload + Small modifications</a></div>
                                <div class="proposal">Including <b>16</b> deliverables</div>
                                <div class="purchased"><b>Closed</b> on September 30th 2013</div>
                            </td>
                            
                            <td class="status">
                                <ul>
                                    <li><a href="#1">Pending</a></li>
                                    <li><a href="#2">Sent</a></li>
                                    <li><a href="#3" class="paid">Paid</a></li>
                                </ul>
                            </td>
                            <td class="subtotal">
                                $ 800
                            </td>
                        </tr>
                        <tr>
                            <td class="number">00002</td>
                            <td class="description">
                                <div class="title"><a href="#">Invoice #00002</a></div>
                                <div class="proposal">Including <b>16</b> deliverables</div>
                                <div class="purchased"><b>Closed</b> on September 30th 2013</div>
                            </td>
                            
                            <td class="status">
                                <ul>
                                    <li><a href="#1">Pending</a></li>
                                    <li><a href="#2" class="inprocess">Sent</a></li>
                                    <li><a href="#3">Paid</a></li>
                                </ul>
                            </td>
                            <td class="subtotal">
                                $ 175
                            </td>
                        </tr>
                        <tr>
                            <td class="number">00003</td>
                            <td class="description">
                                <div class="title"><a href="#">One last small modification</a></div>
                                <div class="proposal">Including <b>16</b> deliverables</div>
                                <div class="purchased"><b>Closed</b> on September 30th 2013</div>
                            </td>
                            
                            <td class="status">
                                <ul>
                                    <li><a href="#1" class="inprocess">Pending</a></li>
                                    <li><a href="#2">Sent</a></li>
                                    <li><a href="#3">Paid</a></li>
                                </ul>
                            </td>
                            <td class="subtotal">
                                $ 42.50
                            </td>
                        </tr>

                    </tbody>
                </table>
            </div> 
{% endblock %}
{#block bottom_js %}
<script type="text/javascript" src="{{asset("/js/ng_order_edit.js")}}"></script>
<script type="text/javascript">
(function(ng, module){
    
    module.value("form_name", "{{form.vars.name}}");

})(angular, module);
</script>
{% endblock #}
